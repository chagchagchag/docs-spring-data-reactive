## MongoCollection 의 다양한 연산들

## 참고자료

- mongodb.github.io/mongo-java-driver
  - [dirver core](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/index.html) : [Aggregates](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/Aggregates.html), [Filters](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/Filters.html) 등 다양한 집계 연산을 위한 core 라이브러리 및 여러가지 codec, geojson 등이 포함된 라이브러리입니다.
    - Aggregates, Filters 등과 같은 필터나 Aggregate 를 Bson 으로 생성하는 헬퍼 팩토리 메서드 들은 주로 [com.mongodb.client.model](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/package-summary.html) 에 위치해있습니다.
  - [Java Reactive Streams Driver](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/index.html)



<br/>



## 요약

기본 연산

- [countDocuments](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#countDocuments(com.mongodb.reactivestreams.client.ClientSession,org.bson.conversions.Bson,com.mongodb.client.model.CountOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html) filter, [CountOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/CountOptions.html) options)
- [find](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#find(com.mongodb.reactivestreams.client.ClientSession,org.bson.conversions.Bson))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html) filter)
- [aggregate](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#aggregate(java.util.List))([List](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)\<? extends [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html)\> pipeline)
- [watch](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#watch(com.mongodb.reactivestreams.client.ClientSession,java.util.List))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [List](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)\<? extends [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html)\> pipeline)
- [bulkWrite](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#bulkWrite(com.mongodb.reactivestreams.client.ClientSession,java.util.List,com.mongodb.client.model.BulkWriteOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [List](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)\<? extends [WriteModel](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/WriteModel.html)\<? extends [TDocument](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html)\>\> requests, [BulkWriteOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/BulkWriteOptions.html) options)
- [insertOne](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#insertOne(com.mongodb.reactivestreams.client.ClientSession,TDocument,com.mongodb.client.model.InsertOneOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [TDocument](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html) document, [InsertOneOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/InsertOneOptions.html) options)
- [insertMany](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#insertMany(com.mongodb.reactivestreams.client.ClientSession,java.util.List,com.mongodb.client.model.InsertManyOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [List](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)\<? extends [TDocument](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html)\> documents, [InsertManyOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/InsertManyOptions.html) options)
- [updateOne](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#updateOne(com.mongodb.reactivestreams.client.ClientSession,org.bson.conversions.Bson,java.util.List,com.mongodb.client.model.UpdateOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html) filter, [List](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)\<? extends [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html)\> update, [UpdateOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/UpdateOptions.html) options)
- [updateMany](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#updateMany(com.mongodb.reactivestreams.client.ClientSession,org.bson.conversions.Bson,java.util.List,com.mongodb.client.model.UpdateOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html) filter, [List](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)\<? extends [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html)\> update, [UpdateOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/UpdateOptions.html) options)

<br/>



atomic 연산

- [findOneAndDelete](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#findOneAndDelete(com.mongodb.reactivestreams.client.ClientSession,org.bson.conversions.Bson,com.mongodb.client.model.FindOneAndDeleteOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html) filter, [FindOneAndDeleteOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/FindOneAndDeleteOptions.html) options)
- [findOneAndReplace](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#findOneAndReplace(com.mongodb.reactivestreams.client.ClientSession,org.bson.conversions.Bson,TDocument,com.mongodb.client.model.FindOneAndReplaceOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html) filter, [TDocument](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html) replacement, [FindOneAndReplaceOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/FindOneAndReplaceOptions.html) options)
- [findOneAndUpdate](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#findOneAndUpdate(com.mongodb.reactivestreams.client.ClientSession,org.bson.conversions.Bson,java.util.List,com.mongodb.client.model.FindOneAndUpdateOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html) filter, [List](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)\<? extends [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html)\> update, [FindOneAndUpdateOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/FindOneAndUpdateOptions.html) options)

<br/>



index 연산

- [createIndexes](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#createIndexes(com.mongodb.reactivestreams.client.ClientSession,java.util.List,com.mongodb.client.model.CreateIndexOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, List\<[IndexModel](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/IndexModel.html)\> indexes, [CreateIndexOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/CreateIndexOptions.html) createIndexOptions)
- [listIndexes](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#listIndexes(com.mongodb.reactivestreams.client.ClientSession))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession)
- [dropIndex](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#dropIndex(com.mongodb.reactivestreams.client.ClientSession,java.lang.String,com.mongodb.client.model.DropIndexOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [String](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html) indexName, [DropIndexOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/DropIndexOptions.html) dropIndexOptions)

<br/>



## 기본 연산

- [countDocuments](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#countDocuments(com.mongodb.reactivestreams.client.ClientSession,org.bson.conversions.Bson,com.mongodb.client.model.CountOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html) filter, [CountOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/CountOptions.html) options)

- [find](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#find(com.mongodb.reactivestreams.client.ClientSession,org.bson.conversions.Bson))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html) filter)
- [aggregate](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#aggregate(java.util.List))([List](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)\<? extends [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html)\> pipeline)
- [watch](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#watch(com.mongodb.reactivestreams.client.ClientSession,java.util.List))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [List](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)\<? extends [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html)\> pipeline)
- [bulkWrite](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#bulkWrite(com.mongodb.reactivestreams.client.ClientSession,java.util.List,com.mongodb.client.model.BulkWriteOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [List](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)\<? extends [WriteModel](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/WriteModel.html)\<? extends [TDocument](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html)\>\> requests, [BulkWriteOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/BulkWriteOptions.html) options)
- [insertOne](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#insertOne(com.mongodb.reactivestreams.client.ClientSession,TDocument,com.mongodb.client.model.InsertOneOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [TDocument](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html) document, [InsertOneOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/InsertOneOptions.html) options)
- [insertMany](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#insertMany(com.mongodb.reactivestreams.client.ClientSession,java.util.List,com.mongodb.client.model.InsertManyOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [List](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)\<? extends [TDocument](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html)\> documents, [InsertManyOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/InsertManyOptions.html) options)
- [updateOne](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#updateOne(com.mongodb.reactivestreams.client.ClientSession,org.bson.conversions.Bson,java.util.List,com.mongodb.client.model.UpdateOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html) filter, [List](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)\<? extends [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html)\> update, [UpdateOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/UpdateOptions.html) options)
- [updateMany](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#updateMany(com.mongodb.reactivestreams.client.ClientSession,org.bson.conversions.Bson,java.util.List,com.mongodb.client.model.UpdateOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html) filter, [List](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)\<? extends [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html)\> update, [UpdateOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/UpdateOptions.html) options)

<br/>



### countDocuments (...)

>  참고
>
> - [MongoCollection.java](https://github.com/mongodb/mongo-java-driver/blob/master/driver-reactive-streams/src/main/com/mongodb/reactivestreams/client/MongoCollection.java)
>
> - [countDocuments](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#countDocuments(com.mongodb.reactivestreams.client.ClientSession,org.bson.conversions.Bson,com.mongodb.client.model.CountOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html) filter, [CountOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/CountOptions.html) options)

Collection 메타 데이터를 이용해서 컬렉션 내의 Document 의 갯수를 반환합니다.

```java
package com.mongodb.client;
@ThreadSafe
public interface MongoCollection<TDocument> {
    /** 
     * Counts the number of documents in the collection according to the given options.
     * ...
     */
    Publisher<Long> countDocuments(ClientSession clientSession, Bson filter, CountOptions options);
}
```

- [ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) : ClientSession 을 통해서 multi document transaction 을 지원합니다. 
- [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html) filter : Bson 구현채를 이용해서 filter 연산이 가능합니다.
- [CountOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/CountOptions.html) options : hint, limit, skip, maxTime, collation 등과 같은 정보를 Option 으로 넘기는 것이 가능합니다.

<br/>



### find (...)

> 참고
>
> - [MongoCollection.java](https://github.com/mongodb/mongo-java-driver/blob/master/driver-reactive-streams/src/main/com/mongodb/reactivestreams/client/MongoCollection.java)
> - [Filters](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/package-summary.html)
> - [find](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#find(com.mongodb.reactivestreams.client.ClientSession,org.bson.conversions.Bson))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html) filter)

컬렉션 내에서 filter 에 해당되는 모든 도큐먼트들을 불러옵니다.

```java
package com.mongodb.client;
@ThreadSafe
public interface MongoCollection<TDocument> {
    /** 
     * Finds all documents in the collection.
     * ...
     */
    FindPublisher<TDocument> find();
}
```

- [Filters](https://github.com/mongodb/mongo-java-driver/blob/master/driver-core/src/main/com/mongodb/client/model/Filters.java) 에서 제공하는 정적 팩토리 메서드 들 에는 eq, ne, gt, gte, lt, lte, in, nin, and, or, not, nor, exists, type, mod, regex, text 등과 같은 연산자를 지원하는 메서드 들이 있는데 모두 Bson 객체를 Filter 에 맞는 형식으로 객체를 생성하는 메서드 들입니다.
- 자세한 내용은 IDE 에서 Filters 클래스를 찾아보거나 [Filters](https://github.com/mongodb/mongo-java-driver/blob/master/driver-core/src/main/com/mongodb/client/model/Filters.java) 를 참고해주세요.

<br/>



### aggregate (...)

> 참고
>
> - [MongoCollection.java](https://github.com/mongodb/mongo-java-driver/blob/master/driver-reactive-streams/src/main/com/mongodb/reactivestreams/client/MongoCollection.java)
> - [aggregate](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#aggregate(java.util.List))([List](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)\<? extends [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html)\> pipeline)
> - [Aggregates](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/Aggregates.html)

pipline 에 해당하는 Bson 식들에 대해 필터링, 집계, 그루핑 등과 같은 aggregation  을 수행합니다. 

```java
package com.mongodb.client;
@ThreadSafe
public interface MongoCollection<TDocument> {
    /** 
     * Aggregates documents according to the specified aggregation pipeline.
     * ...
     */
    AggregatePublisher<TDocument> aggregate(List<? extends Bson> pipeline);
}
```

<br/>

[Aggregates](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/Aggregates.html) 클래스에서는 aggregation 표현식을 Bson 객체로 생성해내는 다양한 종류의 정적 팩토리 메서드들이  헬퍼 메서드로 존재합니다.<br/>

지원되는 메서드 들은 굉장히 다양하며 그 중 대표적으로 잘 알려진 메서드 들은 아래와 같습니다.

- addFields, set, bucket, bucketAuto
- sort, sortByCount
- count
- match, project
- skip, limit, lookup
- facet, graphLookup, group, unionWith, unwind, out, merge, replaceRoot, replaceWith, sample

<br/>



### watch (...)

> 참고
>
> - [MongoCollection.java](https://github.com/mongodb/mongo-java-driver/blob/master/driver-reactive-streams/src/main/com/mongodb/reactivestreams/client/MongoCollection.java)
> - [watch](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#watch(com.mongodb.reactivestreams.client.ClientSession,java.util.List))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [List](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)\<? extends [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html)\> pipeline)
> - [ChangeStreamPublisher](https://github.com/mongodb/mongo-java-driver/blob/master/driver-reactive-streams/src/main/com/mongodb/reactivestreams/client/ChangeStreamPublisher.java)

컬렉션에 대한 변경사항 발생시 변경사항에 대한 Stream (Change Stream) 을 만들어냅니다.

```java
package com.mongodb.client;
@ThreadSafe
public interface MongoCollection<TDocument> {
    /** 
     * Creates a change stream for this collection.
     * ...
     */
    ChangeStreamPublisher<Document> watch(ClientSession clientSession, List<? extends Bson> pipeline);
}
```

[ChangeStreamPublisher](https://github.com/mongodb/mongo-java-driver/blob/master/driver-reactive-streams/src/main/com/mongodb/reactivestreams/client/ChangeStreamPublisher.java) 타입을 반환합니다. 이렇게 만들어진 ChangeStream 은 subscribe 시에 onNext 이벤트를 통해 읽어들여집니다.<br/>



### bulkWrite (...)

> 참고
>
> - [MongoCollection.java](https://github.com/mongodb/mongo-java-driver/blob/master/driver-reactive-streams/src/main/com/mongodb/reactivestreams/client/MongoCollection.java)
> - [bulkWrite](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#bulkWrite(com.mongodb.reactivestreams.client.ClientSession,java.util.List,com.mongodb.client.model.BulkWriteOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [List](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)\<? extends [WriteModel](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/WriteModel.html)\<? extends [TDocument](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html)\>\> requests, [BulkWriteOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/BulkWriteOptions.html) options)
> - [BulkWriteOptions](https://github.com/mongodb/mongo-java-driver/blob/master/driver-core/src/main/com/mongodb/client/model/BulkWriteOptions.java)
> - [WriteModel](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/WriteModel.html)

insert, updates, replaces, delete 연산을 한번에 모아서 bulk 연산을 수행합니다.<br/>

```java
package com.mongodb.client;
@ThreadSafe
public interface MongoCollection<TDocument> {
    /** 
     * Executes a mix of inserts, updates, replaces, and deletes.
     * ...
     */
    Publisher<BulkWriteResult> bulkWrite(ClientSession clientSession, List<? extends WriteModel<? extends TDocument>> requests,
                              BulkWriteOptions options);
}
```

입력인자를 보면 [WriteModel](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/WriteModel.html) 이 보입니다. 이 WriteModel 은 interface 이며 구체타입 들은 아래와 같습니다.

- [DeleteManyModel](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/DeleteManyModel.html) : 조건을 만족하는 모든 Document 를 찾아서 모두 삭제할 수 있도록 표현된 Model 객체입니다.
- [DeleteOneModel](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/DeleteOneModel.html) : 조건을 만족하는 하나의 Document 를 찾아서 삭제할 수 있도록 표현된 Model 객체입니다.
- [InsertOneModel](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/InsertOneModel.html) : 하나의 Document 를 Inert 할 수 있도록 표현된 Model 객체입니다.
- [ReplaceOneModel](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/ReplaceOneModel.html) : 조건을 만족하는 하나의 Document 를 찾아서 Replace 할 수 있도록 표현된 Model 객체입니다.
- [UpdateManyModel](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/UpdateManyModel.html) : 조건을 만족하는 2개 이상의 Document 를 찾아서 수정할 수 있도록 표현된 Model 객체입니다.
- [UpdateOneModel](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/UpdateOneModel.html) : 조건을 만족하는 하나의 Document 를 찾아서 수정할 수 있도록 표현된 Model 객체입니다.

<br/>



### insertOne (...)

> 참고
>
> - [MongoCollection.java](https://github.com/mongodb/mongo-java-driver/blob/master/driver-reactive-streams/src/main/com/mongodb/reactivestreams/client/MongoCollection.java)
> - [insertOne](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#insertOne(com.mongodb.reactivestreams.client.ClientSession,TDocument,com.mongodb.client.model.InsertOneOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [TDocument](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html) document, [InsertOneOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/InsertOneOptions.html) options)
> - [InsertOneOptions](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/InsertOneOptions.html), [InsertOneOptions.java](https://github.com/mongodb/mongo-java-driver/blob/master/driver-core/src/main/com/mongodb/client/model/InsertOneOptions.java)

하나의 document 를 insert 할 수 있도록 MongoCollection 클래스에서 지원되는 메서드입니다.<br/>

만약 id 와 같은 식별자가 누락되어 있다면, mongodb-java-driver 가 자동으로 생성합니다.


```java
package com.mongodb.client;
// ...
@ThreadSafe
public interface MongoCollection<TDocument> {
    /** 
     * Inserts the provided document. If the document is missing an identifier, the driver should generate one.
     * ...
     */
    Publisher<InsertOneResult> insertOne(ClientSession clientSession, TDocument document, InsertOneOptions options);
}
```

<br/>

[InsertOneOptions](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/InsertOneOptions.html) 가 보입니다. InsertOneOptions 는 validation 을 우회할 지 결정하는 필드를가지고 있습니다. 

```java
package com.mongodb.client.model;
/**
 * The options to apply to an operation that inserts a single document into a collection.
 */
public final class InsertOneOptions {
    private Boolean bypassDocumentValidation;
    private BsonValue comment;
    // ... 
}
```

<br/>



### insertMany (...)

> 참고
>
> - [MongoCollection.java](https://github.com/mongodb/mongo-java-driver/blob/master/driver-reactive-streams/src/main/com/mongodb/reactivestreams/client/MongoCollection.java)
> - [insertMany](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#insertMany(com.mongodb.reactivestreams.client.ClientSession,java.util.List,com.mongodb.client.model.InsertManyOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [List](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)\<? extends [TDocument](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html)\> documents, [InsertManyOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/InsertManyOptions.html) options)
> - [InsertManyOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/InsertManyOptions.html), [InsertManyOptions.java](https://github.com/mongodb/mongo-java-driver/blob/master/driver-core/src/main/com/mongodb/client/model/InsertManyOptions.java)

여러개의 Document 를 insert 할 수 있도록 제공되는 메서드입니다.


```java
package com.mongodb.client;
// ...
@ThreadSafe
public interface MongoCollection<TDocument> {
    /** 
     * Inserts one or more documents.  A call to this method is equivalent to a call to the {@code bulkWrite} method
     * ...
     */
    Publisher<InsertManyResult> insertMany(ClientSession clientSession, List<? extends TDocument> documents, InsertManyOptions options);
}
```



<br/>

[InsertManyOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/InsertManyOptions.html) 가 보입니다. InsertManyOptions 는 validation 을 우회할 지, insert 순서를 보장할지를 결정하는 필드들을 가지고 있습니다.

```java
package com.mongodb.client.model;
/**
 * The options to apply to an operation that inserts multiple documents into a collection.
 */
public final class InsertManyOptions {
    private boolean ordered = true;
    private Boolean bypassDocumentValidation;
    private BsonValue comment;
    // ...
}
```

<br/>



### updateOne (...)

> 참고
>
> - [MongoCollection.java](https://github.com/mongodb/mongo-java-driver/blob/master/driver-reactive-streams/src/main/com/mongodb/reactivestreams/client/MongoCollection.java)
> - [updateOne](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#updateOne(com.mongodb.reactivestreams.client.ClientSession,org.bson.conversions.Bson,java.util.List,com.mongodb.client.model.UpdateOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html) filter, [List](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)\<? extends [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html)\> update, [UpdateOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/UpdateOptions.html) options)
> - [UpdateOptions](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/UpdateOptions.html), [UpdateOptions.java](https://github.com/mongodb/mongo-java-driver/blob/master/driver-core/src/main/com/mongodb/client/model/UpdateOptions.java)

filter 를 통해 찾아지는 도큐먼트 1개를 update 하는 연산이며, UpdateOptions 를 통해서 upsert, hint, collation, variables 를 명시할 수 있습니다.


```java
package com.mongodb.client;
// ...
@ThreadSafe
public interface MongoCollection<TDocument> {
    /** 
     * Update a single document in the collection according to the specified arguments.
     * ...
     */
    Publisher<UpdateResult> updateOne(Bson filter, List<? extends Bson> update, UpdateOptions updateOptions);
}
```

<br/>

[UpdateOptions](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/UpdateOptions.html) 가 보입니다. UpdateOptions 에는 아래와 같이 upsert, hint, collation, variables 등을 지정할 수 있는 필드들이 있습니다.

```java
package com.mongodb.client.model;

/**
 * The options to apply when updating documents.
 */
public class UpdateOptions {
    private boolean upsert;
    private Boolean bypassDocumentValidation;
    private Collation collation;
    private List<? extends Bson> arrayFilters;
    private Bson hint;
    private String hintString;
    private BsonValue comment;
    private Bson variables;
    // ...
}
```

<br/>



### updateMany (...)

> 참고
>
> - [MongoCollection.java](https://github.com/mongodb/mongo-java-driver/blob/master/driver-reactive-streams/src/main/com/mongodb/reactivestreams/client/MongoCollection.java)
> - [updateMany](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#updateMany(com.mongodb.reactivestreams.client.ClientSession,org.bson.conversions.Bson,java.util.List,com.mongodb.client.model.UpdateOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html) filter, [List](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)\<? extends [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html)\> update, [UpdateOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/UpdateOptions.html) options)

filter 를 통해 찾아지는 1개 또는 두개 이상의 모든 도큐먼트들을 update 하는 연산이며, UpdateOptions 를 통해서 upsert, hint, collation, variables 를 명시할 수 있습니다.

```java
package com.mongodb.client;
// ...
@ThreadSafe
public interface MongoCollection<TDocument> {
    /** 
     * Update all documents in the collection according to the specified arguments.
     * ...
     */
    Publisher<UpdateResult> updateMany(ClientSession clientSession, Bson filter, Bson update, UpdateOptions updateOptions);
}
```



<br/>

[UpdateOptions](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/UpdateOptions.html) 가 보입니다. UpdateOptions 에는 아래와 같이 upsert, hint, collation, variables 등을 지정할 수 있는 필드들이 있습니다.

```java
package com.mongodb.client.model;

/**
 * The options to apply when updating documents.
 */
public class UpdateOptions {
    private boolean upsert;
    private Boolean bypassDocumentValidation;
    private Collation collation;
    private List<? extends Bson> arrayFilters;
    private Bson hint;
    private String hintString;
    private BsonValue comment;
    private Bson variables;
    // ...
}
```

<br/>



## atomic 연산

- [findOneAndDelete](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#findOneAndDelete(com.mongodb.reactivestreams.client.ClientSession,org.bson.conversions.Bson,com.mongodb.client.model.FindOneAndDeleteOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html) filter, [FindOneAndDeleteOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/FindOneAndDeleteOptions.html) options)
- [findOneAndReplace](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#findOneAndReplace(com.mongodb.reactivestreams.client.ClientSession,org.bson.conversions.Bson,TDocument,com.mongodb.client.model.FindOneAndReplaceOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html) filter, [TDocument](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html) replacement, [FindOneAndReplaceOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/FindOneAndReplaceOptions.html) options)
- [findOneAndUpdate](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#findOneAndUpdate(com.mongodb.reactivestreams.client.ClientSession,org.bson.conversions.Bson,java.util.List,com.mongodb.client.model.FindOneAndUpdateOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html) filter, [List](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)\<? extends [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html)\> update, [FindOneAndUpdateOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/FindOneAndUpdateOptions.html) options)



### findOneAndDelete (...)

> 참고
>
> - [MongoCollection.java](https://github.com/mongodb/mongo-java-driver/blob/master/driver-reactive-streams/src/main/com/mongodb/reactivestreams/client/MongoCollection.java)
> - [findOneAndDelete](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#findOneAndDelete(com.mongodb.reactivestreams.client.ClientSession,org.bson.conversions.Bson,com.mongodb.client.model.FindOneAndDeleteOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html) filter, [FindOneAndDeleteOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/FindOneAndDeleteOptions.html) options)

원자적으로 도큐먼트 하나를 찾아낸 후 삭제하는 것을 보장하는 연산입니다.<br/>

```java
package com.mongodb.client;
// ...
@ThreadSafe
public interface MongoCollection<TDocument> {
    /** 
     * Atomically find a document and remove it.
     * ...
     */
    Publisher<TDocument> findOneAndDelete(ClientSession clientSession, Bson filter, FindOneAndDeleteOptions options);
}
```



<br/>

FindOneAndDeleteOptions.java 의 내용은 아래와 같습니다. 

sort 옵션, collation 옵션, hint 옵션, comment 옵션을 따로 지정할 수 있습니다.

```java
package com.mongodb.client.model;

/**
 * The options to apply to an operation that atomically finds a document and deletes it.
 */
public class FindOneAndDeleteOptions {
    private Bson projection;
    private Bson sort;
    private long maxTimeMS;
    private Collation collation;
    private Bson hint;
    private String hintString;
    private BsonValue comment;
    private Bson variables;
    
    // ...
}
```

<br/>



### findOneAndReplace (...)

> 참고
>
> - [MongoCollection.java](https://github.com/mongodb/mongo-java-driver/blob/master/driver-reactive-streams/src/main/com/mongodb/reactivestreams/client/MongoCollection.java)
> - [findOneAndReplace](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#findOneAndReplace(com.mongodb.reactivestreams.client.ClientSession,org.bson.conversions.Bson,TDocument,com.mongodb.client.model.FindOneAndReplaceOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html) filter, [TDocument](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html) replacement, [FindOneAndReplaceOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/FindOneAndReplaceOptions.html) options)

filter 에 해당하는 하나의 도큐먼트를 찾아서 원자적으로 Replace 하는 것이 보장되는 함수입니다.

```java
package com.mongodb.client;
// ...
@ThreadSafe
public interface MongoCollection<TDocument> {
    /** 
     * Atomically find a document and replace it.
     * ...
     */
    @Nullable
    Publisher<TDocument> findOneAndReplace(ClientSession clientSession, Bson filter, TDocument replacement, FindOneAndReplaceOptions options);
}
```

<br/>



[FindOneAndReplaceOptions](https://github.com/mongodb/mongo-java-driver/blob/master/driver-core/src/main/com/mongodb/client/model/FindOneAndReplaceOptions.java) 의 코드는 아래와 같습니다. hint, sort, upsert 여부, validation 을 건너뛸지에 대한 여부인 bypassDocumentValidation, collation, hint 를 지정할 수 있음을 확인 가능합니다.

```java
package com.mongodb.client.model;

/**
 * The options to apply to an operation that atomically finds a document and replaces it.
 */
public class FindOneAndReplaceOptions {
    private Bson projection;
    private Bson sort;
    private boolean upsert;
    private ReturnDocument returnDocument = ReturnDocument.BEFORE;
    private long maxTimeMS;
    private Boolean bypassDocumentValidation;
    private Collation collation;
    private Bson hint;
    private String hintString;
    private BsonValue comment;
    private Bson variables;
    // ...
}
```

<br/>



### findOneAndUpdate(...)

> 참고
>
> - [MongoCollection.java](https://github.com/mongodb/mongo-java-driver/blob/master/driver-reactive-streams/src/main/com/mongodb/reactivestreams/client/MongoCollection.java)
> - [findOneAndUpdate](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#findOneAndUpdate(com.mongodb.reactivestreams.client.ClientSession,org.bson.conversions.Bson,java.util.List,com.mongodb.client.model.FindOneAndUpdateOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html) filter, [List](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/List.html)\<? extends [Bson](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/bson/org/bson/conversions/Bson.html)\> update, [FindOneAndUpdateOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/FindOneAndUpdateOptions.html) options)

filter 에 해당하는 하나의 도큐먼트를 찾아서 원자적으로 Update 하는 것이 보장되는 함수입니다.

```java
package com.mongodb.client;
// ...
@ThreadSafe
public interface MongoCollection<TDocument> {
    /** 
     * Atomically find a document and update it.
     * ...
     */
    @Nullable
    Publisher<TDocument> findOneAndUpdate(Bson filter, List<? extends Bson> update, FindOneAndUpdateOptions options);
}
```

<br/>



[FindOneAndUpdateOptions.java](https://github.com/mongodb/mongo-java-driver/blob/master/driver-core/src/main/com/mongodb/client/model/FindOneAndUpdateOptions.java) 의 코드는 아래와 같습니다. upsert 여부, sort 를 어떻게할지, validation 을 skip 할지에 대한 옵션인 bypassDocumentValidation, collation, hint 를 옵션으로 설정할 수 있음을 확인 가능합니다.

```java
package com.mongodb.client.model;

// ...

/**
 * The options to apply to an operation that atomically finds a document and updates it.
 */
public class FindOneAndUpdateOptions {
    private Bson projection;
    private Bson sort;
    private boolean upsert;
    private ReturnDocument returnDocument = ReturnDocument.BEFORE;
    private long maxTimeMS;
    private Boolean bypassDocumentValidation;
    private Collation collation;
    private List<? extends Bson> arrayFilters;
    private Bson hint;
    private String hintString;
    private BsonValue comment;
    private Bson variables;
    // ...
}
```

<br/>



## index 연산

컬렉션의 특정 필드들에 대해 insdex 생성, 조회, 삭제 기능을 제공합니다. 

- [createIndexes](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#createIndexes(com.mongodb.reactivestreams.client.ClientSession,java.util.List,com.mongodb.client.model.CreateIndexOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, List\<[IndexModel](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/IndexModel.html)\> indexes, [CreateIndexOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/CreateIndexOptions.html) createIndexOptions)
- [listIndexes](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#listIndexes(com.mongodb.reactivestreams.client.ClientSession))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession)
- [dropIndex](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#dropIndex(com.mongodb.reactivestreams.client.ClientSession,java.lang.String,com.mongodb.client.model.DropIndexOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [String](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html) indexName, [DropIndexOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/DropIndexOptions.html) dropIndexOptions)

<br/>



### createIndexes (...)

> 참고
>
> - [MongoCollection.java](https://github.com/mongodb/mongo-java-driver/blob/master/driver-reactive-streams/src/main/com/mongodb/reactivestreams/client/MongoCollection.java)
> - [createIndexes](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#createIndexes(com.mongodb.reactivestreams.client.ClientSession,java.util.List,com.mongodb.client.model.CreateIndexOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, List\<[IndexModel](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/IndexModel.html)\> indexes, [CreateIndexOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/CreateIndexOptions.html) createIndexOptions)

인자로 전달된 IndexModel 리스트에 대해 여러개의 인덱스들을 생성하는 역할을 하는 메서드입니다.


```java
package com.mongodb.client;
// ...
@ThreadSafe
public interface MongoCollection<TDocument> {
    /** 
     * Create multiple indexes.
     * ...
     */
    Publisher<String> createIndexes(ClientSession clientSession, List<IndexModel> indexes, CreateIndexOptions createIndexOptions);
}
```

<br/>



[CreateIndexOptions.java](https://github.com/mongodb/mongo-java-driver/blob/master/driver-core/src/main/com/mongodb/client/model/CreateIndexOptions.java) 의 내용은 아래와 같습니다.

- maxTimeMS : 연산 수행시 최대 몇 ms 만큼을 기다릴지를 결정합니다.
- commitQuorum : 커밋 시에 여러 브로커 들 간에 투표시 어떻게 할지에 대한 옵션입니다. Quorum은 분산 시스템에서 데이터 일관성과 가용성을 보장하기 위한 개념 중 하나입니다.

```java
package com.mongodb.client.model;

/**
 * The options to apply to the command when creating indexes.
 *
 * @mongodb.driver.manual reference/command/createIndexes Index options
 * @since 3.6
 */
public class CreateIndexOptions {
    private long maxTimeMS;
    private CreateIndexCommitQuorum commitQuorum;
    // ...
}
```

<br/>



### listIndexes (...)

> 참고
>
> - [MongoCollection.java](https://github.com/mongodb/mongo-java-driver/blob/master/driver-reactive-streams/src/main/com/mongodb/reactivestreams/client/MongoCollection.java)
> - [listIndexes](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#listIndexes(com.mongodb.reactivestreams.client.ClientSession))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession)

컬렉션에 존재하는 모든 index 들을 조회하는 메서드입니다.

```java
package com.mongodb.client;
// ...
@ThreadSafe
public interface MongoCollection<TDocument> {
    /** 
     * Get all the indexes in this collection.
     * ...
     */
    ListIndexesPublisher<Document> listIndexes(ClientSession clientSession);
}
```

<br/>



### dropIndex (...)

> 참고
>
> - [MongoCollection.java](https://github.com/mongodb/mongo-java-driver/blob/master/driver-reactive-streams/src/main/com/mongodb/reactivestreams/client/MongoCollection.java)
> - [dropIndex](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/MongoCollection.html#dropIndex(com.mongodb.reactivestreams.client.ClientSession,java.lang.String,com.mongodb.client.model.DropIndexOptions))([ClientSession](https://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-reactivestreams/com/mongodb/reactivestreams/client/ClientSession.html) clientSession, [String](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/String.html) indexName, [DropIndexOptions](http://mongodb.github.io/mongo-java-driver/5.0/apidocs/mongodb-driver-core/com/mongodb/client/model/DropIndexOptions.html) dropIndexOptions)

컬렉션에서 indexName 에 해당하는 인덱스를 DROP 하는 역할의 메서드 입니다.

```java
package com.mongodb.client;
// ...
@ThreadSafe
public interface MongoCollection<TDocument> {
    /** 
     * Drops the index given its name.
     * ...
     */
    Publisher<Void> dropIndex(ClientSession clientSession, String indexName, DropIndexOptions dropIndexOptions);
}
```

<br/>



[DropIndexOptions.java](https://github.com/mongodb/mongo-java-driver/blob/master/driver-core/src/main/com/mongodb/client/model/DropIndexOptions.java) 의 내용은 아래와 같습니다.

```java
package com.mongodb.client.model;
// ...

/**
 * The options to apply to the command when dropping indexes.
 */
public class DropIndexOptions {
    private long maxTimeMS;
    // ...
}
```

<br/>







